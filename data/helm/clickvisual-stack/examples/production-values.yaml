# Production Configuration - 生产环境配置
# 适用于：生产环境、高可用部署

# 全局配置
global:
  storageClass: "fast-ssd"  # 使用高性能存储

# ClickVisual 高可用配置
clickvisual:
  enabled: true
  replicaCount: 3

  image:
    repository: clickvisual/clickvisual
    tag: "v1.0.0"  # 使用固定版本
    pullPolicy: IfNotPresent

  service:
    type: ClusterIP
    port: 19001

  # 启用 Ingress
  ingress:
    enabled: true
    className: "nginx"
    annotations:
      cert-manager.io/cluster-issuer: "letsencrypt-prod"
      nginx.ingress.kubernetes.io/ssl-redirect: "true"
      nginx.ingress.kubernetes.io/proxy-body-size: "100m"
    hosts:
      - host: clickvisual.yourdomain.com
        paths:
          - path: /
            pathType: Prefix
    tls:
      - secretName: clickvisual-tls
        hosts:
          - clickvisual.yourdomain.com

  # 生产环境配置
  config:
    secretKey: "your-strong-random-secret-key-32chars"
    rootURL: "https://clickvisual.yourdomain.com"
    logLevel: "info"
    isMultiCopy: true  # 启用多副本模式
    encryptionKey: "your-32-character-encryption-key!"

    # OAuth 配置（可选）
    oauth:
      github:
        enabled: true
        clientId: "your-github-oauth-client-id"
        clientSecret: "your-github-oauth-client-secret"

  resources:
    limits:
      cpu: 2000m
      memory: 2Gi
    requests:
      cpu: 1000m
      memory: 1Gi

# MySQL 高可用配置
mysql:
  enabled: true

  auth:
    rootPassword: "your-strong-mysql-password"
    database: "clickvisual"

  primary:
    persistence:
      enabled: true
      size: 50Gi
      storageClass: "fast-ssd"

    service:
      type: ClusterIP
      port: 3306

    resources:
      limits:
        cpu: 2000m
        memory: 4Gi
      requests:
        cpu: 1000m
        memory: 2Gi

# Redis 高可用配置
redis:
  enabled: true

  auth:
    enabled: true
    password: "your-strong-redis-password"

  master:
    persistence:
      enabled: true
      size: 10Gi
      storageClass: "fast-ssd"

    service:
      type: ClusterIP
      port: 6379

    resources:
      limits:
        cpu: 1000m
        memory: 2Gi
      requests:
        cpu: 500m
        memory: 1Gi

# ClickHouse 集群配置
clickhouse:
  enabled: true

  auth:
    username: "admin"
    password: "your-strong-clickhouse-password"

  shards: 3
  replicaCount: 2

  persistence:
    enabled: true
    size: 200Gi
    storageClass: "fast-ssd"

  service:
    type: ClusterIP
    ports:
      tcp: 9000
      http: 8123

  resources:
    limits:
      cpu: 8000m
      memory: 16Gi
    requests:
      cpu: 4000m
      memory: 8Gi

# Kafka 集群配置
kafka:
  enabled: true

  replicaCount: 3

  persistence:
    enabled: true
    size: 100Gi
    storageClass: "fast-ssd"

  service:
    type: ClusterIP
    port: 9092

  resources:
    limits:
      cpu: 2000m
      memory: 4Gi
    requests:
      cpu: 1000m
      memory: 2Gi

  # Zookeeper 集群
  zookeeper:
    enabled: true
    replicaCount: 3
    persistence:
      enabled: true
      size: 10Gi
      storageClass: "fast-ssd"
    resources:
      limits:
        cpu: 1000m
        memory: 1Gi
      requests:
        cpu: 500m
        memory: 512Mi

# Fluent-bit 配置
fluentbit:
  enabled: true

  image:
    repository: fluent/fluent-bit
    tag: "2.2.0"

  clusterName: "production-cluster"

  resources:
    limits:
      cpu: 500m
      memory: 512Mi
    requests:
      cpu: 200m
      memory: 256Mi

# Prometheus 监控（可选）
prometheus:
  enabled: true

  server:
    retention: "30d"
    persistence:
      enabled: true
      size: 50Gi
      storageClass: "fast-ssd"

    resources:
      limits:
        cpu: 2000m
        memory: 4Gi
      requests:
        cpu: 1000m
        memory: 2Gi

  alertmanager:
    enabled: true
    persistence:
      enabled: true
      size: 5Gi

    resources:
      limits:
        cpu: 500m
        memory: 512Mi
      requests:
        cpu: 200m
        memory: 256Mi
